task build {
    dependsOn "api-handler:build"
    dependsOn "worker:build"
}

subprojects {
    task copyNodeModules(type: Copy) {
        dependsOn npmInstall
        from "node_modules"
        into "build/staging/node_modules"
        exclude awsAvailableLibraries
    }

    task copySource(type: Copy) {
        from "src"
        into "build/staging/"
    }

    task build(type: Zip) {
        dependsOn copySource, copyNodeModules
        archiveName "lambda.zip"
        destinationDir file("build/dist")
        from "build/staging"
    }
}
